"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:path");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=C%3A%5CCode%5Ccleanup%5CCivicLangApp%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CCode%5Ccleanup%5CCivicLangApp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=C%3A%5CCode%5Ccleanup%5CCivicLangApp%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CCode%5Ccleanup%5CCivicLangApp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Code_cleanup_CivicLangApp_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/chat/route.ts */ \"(rsc)/./app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"C:\\\\Code\\\\cleanup\\\\CivicLangApp\\\\app\\\\api\\\\chat\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Code_cleanup_CivicLangApp_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDQ29kZSU1Q2NsZWFudXAlNUNDaXZpY0xhbmdBcHAlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNDb2RlJTVDY2xlYW51cCU1Q0NpdmljTGFuZ0FwcCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDUztBQUN0RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL2NpdmljbGFuZy8/N2ZmNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxDb2RlXFxcXGNsZWFudXBcXFxcQ2l2aWNMYW5nQXBwXFxcXGFwcFxcXFxhcGlcXFxcY2hhdFxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY2hhdC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2NoYXRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2NoYXQvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxDb2RlXFxcXGNsZWFudXBcXFxcQ2l2aWNMYW5nQXBwXFxcXGFwcFxcXFxhcGlcXFxcY2hhdFxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvY2hhdC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=C%3A%5CCode%5Ccleanup%5CCivicLangApp%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CCode%5Ccleanup%5CCivicLangApp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/chat/route.ts":
/*!*******************************!*\
  !*** ./app/api/chat/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   maxDuration: () => (/* binding */ maxDuration)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n/* harmony import */ var _lib_rag__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/rag */ \"(rsc)/./lib/rag.ts\");\n// app/api/chat/route.ts\n\n\n\nconst client = process.env.OPENAI_API_KEY ? new openai__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n}) : null;\nconst ISO_TO_NAME = {\n    en: \"English\",\n    es: \"Spanish\",\n    zh: \"Chinese (Simplified)\",\n    \"zh-TW\": \"Chinese (Traditional)\",\n    ko: \"Korean\",\n    fa: \"Persian\",\n    vi: \"Vietnamese\"\n};\nfunction systemPrompt(targetLanguageName) {\n    return [\n        `You are Civic Chat, a helpful assistant for Irvine residents.`,\n        `ALWAYS reply in ${targetLanguageName}.`,\n        `Start with clear, numbered, step-by-step instructions (1., 2., 3., …).`,\n        `After the steps, include brief bullet points with key links, phone numbers, or office hours if relevant.`,\n        `If you used local context snippets, add: \"Sources: [#1 label], [#2 label]\".`,\n        `If missing details, state what you need and ask up to 2 clarifying questions.`\n    ].join(\"\\n\");\n}\nconst maxDuration = 30;\nasync function POST(req) {\n    try {\n        const body = await req.json();\n        // Normalize inputs to a conversation history + language\n        let history = body.messages ?? [];\n        let requestedLang = body.language ?? \"auto\";\n        if ((!history || history.length === 0) && body.question) {\n            history = [\n                {\n                    role: \"user\",\n                    content: body.question\n                }\n            ];\n            if (body.lang) requestedLang = body.lang;\n        }\n        // Last user message for retrieval + guard\n        const lastUser = [\n            ...history\n        ].reverse().find((m)=>m.role === \"user\")?.content ?? \"\";\n        if (!lastUser) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                reply: \"Please provide a question to begin.\",\n                detectedLanguage: \"en\"\n            }, {\n                status: 400\n            });\n        }\n        // Tiny file-based RAG context (safe no-op if no /data)\n        const rag = await (0,_lib_rag__WEBPACK_IMPORTED_MODULE_1__.getRagContext)(lastUser);\n        const target = requestedLang === \"auto\" ? \"the user's language\" : ISO_TO_NAME[requestedLang] ?? \"the user's language\";\n        const sys = {\n            role: \"system\",\n            content: systemPrompt(target)\n        };\n        // Sandwich the latest user message with local context\n        const userWithRag = [\n            `USER QUESTION:\\n${lastUser}`,\n            rag ? `\\n\\nLOCAL CONTEXT (use if relevant; otherwise ignore):\\n${rag}\\n\\n— end of context —` : \"\"\n        ].join(\"\");\n        // Keep conversation memory, but ensure our server-side system prompt is first\n        const modelMessages = [\n            sys,\n            ...(history ?? []).filter((m)=>m.role !== \"system\"),\n            {\n                role: \"user\",\n                content: userWithRag\n            }\n        ];\n        // Demo fallback if no key is set — keeps UI functional\n        if (!client) {\n            const demo = [\n                \"1. Open the city services portal.\",\n                \"2. Select the category and enter your address.\",\n                \"3. Describe the issue and submit the form.\",\n                \"\",\n                \"• Phone: 949-724-6000\",\n                \"• Sources: Irvine Public Works\"\n            ].join(\"\\n\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                reply: demo,\n                detectedLanguage: requestedLang === \"auto\" ? \"en\" : requestedLang\n            });\n        }\n        const completion = await client.chat.completions.create({\n            model: process.env.OPENAI_MODEL || \"gpt-4o-mini\",\n            temperature: 0.2,\n            messages: modelMessages.map((m)=>({\n                    role: m.role,\n                    content: m.content\n                }))\n        });\n        const reply = completion.choices[0]?.message?.content?.trim() || \"I couldn’t generate a reply. Please try again.\";\n        // Simple detection echo (you can improve with a detection pass if you like)\n        const detectedLanguage = requestedLang === \"auto\" ? \"en\" : requestedLang;\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply,\n            detectedLanguage\n        });\n    } catch (err) {\n        return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(`Chat API error: ${err?.message || \"unknown error\"}`, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SSxDQUFDQyxXQUFXLENBQUNDLE1BQU0sQ0FBQztZQUN0REMsT0FBTzlDLFFBQVFDLEdBQUcsQ0FBQzhDLFlBQVksSUFBSTtZQUNuQ0MsYUFBYTtZQUNiNUIsVUFBVW1CLGNBQWNVLEdBQUcsQ0FBQyxDQUFDbEIsSUFBTztvQkFBRU4sTUFBTU0sRUFBRU4sSUFBSTtvQkFBRUMsU0FBU0ssRUFBRUwsT0FBTztnQkFBQztRQUN6RTtRQUVBLE1BQU1NLFFBQ0pVLFdBQVdRLE9BQU8sQ0FBQyxFQUFFLEVBQUVDLFNBQVN6QixTQUFTMEIsVUFDekM7UUFFRiw0RUFBNEU7UUFDNUUsTUFBTW5CLG1CQUFtQlosa0JBQWtCLFNBQVMsT0FBT0E7UUFFM0QsT0FBT3pCLHFEQUFZQSxDQUFDc0IsSUFBSSxDQUFDO1lBQUVjO1lBQU9DO1FBQWlCO0lBQ3JELEVBQUUsT0FBT29CLEtBQVU7UUFDakIsT0FBTyxJQUFJekQscURBQVlBLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRXlELEtBQUtGLFdBQVcsZ0JBQWdCLENBQUMsRUFBRTtZQUM1RWpCLFFBQVE7UUFDVjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaXZpY2xhbmcvLi9hcHAvYXBpL2NoYXQvcm91dGUudHM/ZGU0NiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBhcHAvYXBpL2NoYXQvcm91dGUudHNcbmltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IE9wZW5BSSBmcm9tIFwib3BlbmFpXCI7XG5pbXBvcnQgeyBnZXRSYWdDb250ZXh0IH0gZnJvbSBcIkAvbGliL3JhZ1wiO1xuXG50eXBlIFJvbGUgPSBcInVzZXJcIiB8IFwiYXNzaXN0YW50XCIgfCBcInN5c3RlbVwiO1xudHlwZSBDaGF0TWVzc2FnZSA9IHsgcm9sZTogUm9sZTsgY29udGVudDogc3RyaW5nIH07XG5cbmNvbnN0IGNsaWVudCA9XG4gIHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZID8gbmV3IE9wZW5BSSh7IGFwaUtleTogcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVkgfSkgOiBudWxsO1xuXG5jb25zdCBJU09fVE9fTkFNRTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgZW46IFwiRW5nbGlzaFwiLFxuICBlczogXCJTcGFuaXNoXCIsXG4gIHpoOiBcIkNoaW5lc2UgKFNpbXBsaWZpZWQpXCIsXG4gIFwiemgtVFdcIjogXCJDaGluZXNlIChUcmFkaXRpb25hbClcIixcbiAga286IFwiS29yZWFuXCIsXG4gIGZhOiBcIlBlcnNpYW5cIixcbiAgdmk6IFwiVmlldG5hbWVzZVwiLFxufTtcblxuZnVuY3Rpb24gc3lzdGVtUHJvbXB0KHRhcmdldExhbmd1YWdlTmFtZTogc3RyaW5nKSB7XG4gIHJldHVybiBbXG4gICAgYFlvdSBhcmUgQ2l2aWMgQ2hhdCwgYSBoZWxwZnVsIGFzc2lzdGFudCBmb3IgSXJ2aW5lIHJlc2lkZW50cy5gLFxuICAgIGBBTFdBWVMgcmVwbHkgaW4gJHt0YXJnZXRMYW5ndWFnZU5hbWV9LmAsXG4gICAgYFN0YXJ0IHdpdGggY2xlYXIsIG51bWJlcmVkLCBzdGVwLWJ5LXN0ZXAgaW5zdHJ1Y3Rpb25zICgxLiwgMi4sIDMuLCDigKYpLmAsXG4gICAgYEFmdGVyIHRoZSBzdGVwcywgaW5jbHVkZSBicmllZiBidWxsZXQgcG9pbnRzIHdpdGgga2V5IGxpbmtzLCBwaG9uZSBudW1iZXJzLCBvciBvZmZpY2UgaG91cnMgaWYgcmVsZXZhbnQuYCxcbiAgICBgSWYgeW91IHVzZWQgbG9jYWwgY29udGV4dCBzbmlwcGV0cywgYWRkOiBcIlNvdXJjZXM6IFsjMSBsYWJlbF0sIFsjMiBsYWJlbF1cIi5gLFxuICAgIGBJZiBtaXNzaW5nIGRldGFpbHMsIHN0YXRlIHdoYXQgeW91IG5lZWQgYW5kIGFzayB1cCB0byAyIGNsYXJpZnlpbmcgcXVlc3Rpb25zLmAsXG4gIF0uam9pbihcIlxcblwiKTtcbn1cblxuZXhwb3J0IGNvbnN0IG1heER1cmF0aW9uID0gMzA7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogUmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSAoYXdhaXQgcmVxLmpzb24oKSkgYXMge1xuICAgICAgbWVzc2FnZXM/OiBDaGF0TWVzc2FnZVtdOyAvLyBuZXcgVUkgc2hhcGVcbiAgICAgIGxhbmd1YWdlPzogc3RyaW5nOyAgICAgICAgLy8gXCJhdXRvXCIgfCBJU08gY29kZVxuICAgICAgLy8gbGVnYWN5IChzaW5nbGUtc2hvdCkgZmllbGRzIHN1cHBvcnRlZCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuICAgICAgcXVlc3Rpb24/OiBzdHJpbmc7XG4gICAgICBsYW5nPzogc3RyaW5nO1xuICAgIH07XG5cbiAgICAvLyBOb3JtYWxpemUgaW5wdXRzIHRvIGEgY29udmVyc2F0aW9uIGhpc3RvcnkgKyBsYW5ndWFnZVxuICAgIGxldCBoaXN0b3J5ID0gYm9keS5tZXNzYWdlcyA/PyBbXTtcbiAgICBsZXQgcmVxdWVzdGVkTGFuZyA9IGJvZHkubGFuZ3VhZ2UgPz8gXCJhdXRvXCI7XG5cbiAgICBpZiAoKCFoaXN0b3J5IHx8IGhpc3RvcnkubGVuZ3RoID09PSAwKSAmJiBib2R5LnF1ZXN0aW9uKSB7XG4gICAgICBoaXN0b3J5ID0gW3sgcm9sZTogXCJ1c2VyXCIsIGNvbnRlbnQ6IGJvZHkucXVlc3Rpb24gfV07XG4gICAgICBpZiAoYm9keS5sYW5nKSByZXF1ZXN0ZWRMYW5nID0gYm9keS5sYW5nO1xuICAgIH1cblxuICAgIC8vIExhc3QgdXNlciBtZXNzYWdlIGZvciByZXRyaWV2YWwgKyBndWFyZFxuICAgIGNvbnN0IGxhc3RVc2VyID0gWy4uLmhpc3RvcnldLnJldmVyc2UoKS5maW5kKChtKSA9PiBtLnJvbGUgPT09IFwidXNlclwiKT8uY29udGVudCA/PyBcIlwiO1xuICAgIGlmICghbGFzdFVzZXIpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyByZXBseTogXCJQbGVhc2UgcHJvdmlkZSBhIHF1ZXN0aW9uIHRvIGJlZ2luLlwiLCBkZXRlY3RlZExhbmd1YWdlOiBcImVuXCIgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIFRpbnkgZmlsZS1iYXNlZCBSQUcgY29udGV4dCAoc2FmZSBuby1vcCBpZiBubyAvZGF0YSlcbiAgICBjb25zdCByYWcgPSBhd2FpdCBnZXRSYWdDb250ZXh0KGxhc3RVc2VyKTtcblxuICAgIGNvbnN0IHRhcmdldCA9XG4gICAgICByZXF1ZXN0ZWRMYW5nID09PSBcImF1dG9cIlxuICAgICAgICA/IFwidGhlIHVzZXIncyBsYW5ndWFnZVwiXG4gICAgICAgIDogSVNPX1RPX05BTUVbcmVxdWVzdGVkTGFuZ10gPz8gXCJ0aGUgdXNlcidzIGxhbmd1YWdlXCI7XG5cbiAgICBjb25zdCBzeXMgPSB7IHJvbGU6IFwic3lzdGVtXCIgYXMgY29uc3QsIGNvbnRlbnQ6IHN5c3RlbVByb21wdCh0YXJnZXQpIH07XG5cbiAgICAvLyBTYW5kd2ljaCB0aGUgbGF0ZXN0IHVzZXIgbWVzc2FnZSB3aXRoIGxvY2FsIGNvbnRleHRcbiAgICBjb25zdCB1c2VyV2l0aFJhZyA9IFtcbiAgICAgIGBVU0VSIFFVRVNUSU9OOlxcbiR7bGFzdFVzZXJ9YCxcbiAgICAgIHJhZyA/IGBcXG5cXG5MT0NBTCBDT05URVhUICh1c2UgaWYgcmVsZXZhbnQ7IG90aGVyd2lzZSBpZ25vcmUpOlxcbiR7cmFnfVxcblxcbuKAlCBlbmQgb2YgY29udGV4dCDigJRgIDogXCJcIixcbiAgICBdLmpvaW4oXCJcIik7XG5cbiAgICAvLyBLZWVwIGNvbnZlcnNhdGlvbiBtZW1vcnksIGJ1dCBlbnN1cmUgb3VyIHNlcnZlci1zaWRlIHN5c3RlbSBwcm9tcHQgaXMgZmlyc3RcbiAgICBjb25zdCBtb2RlbE1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdID0gW1xuICAgICAgc3lzLFxuICAgICAgLi4uKGhpc3RvcnkgPz8gW10pLmZpbHRlcigobSkgPT4gbS5yb2xlICE9PSBcInN5c3RlbVwiKSxcbiAgICAgIHsgcm9sZTogXCJ1c2VyXCIsIGNvbnRlbnQ6IHVzZXJXaXRoUmFnIH0sXG4gICAgXTtcblxuICAgIC8vIERlbW8gZmFsbGJhY2sgaWYgbm8ga2V5IGlzIHNldCDigJQga2VlcHMgVUkgZnVuY3Rpb25hbFxuICAgIGlmICghY2xpZW50KSB7XG4gICAgICBjb25zdCBkZW1vID0gW1xuICAgICAgICBcIjEuIE9wZW4gdGhlIGNpdHkgc2VydmljZXMgcG9ydGFsLlwiLFxuICAgICAgICBcIjIuIFNlbGVjdCB0aGUgY2F0ZWdvcnkgYW5kIGVudGVyIHlvdXIgYWRkcmVzcy5cIixcbiAgICAgICAgXCIzLiBEZXNjcmliZSB0aGUgaXNzdWUgYW5kIHN1Ym1pdCB0aGUgZm9ybS5cIixcbiAgICAgICAgXCJcIixcbiAgICAgICAgXCLigKIgUGhvbmU6IDk0OS03MjQtNjAwMFwiLFxuICAgICAgICBcIuKAoiBTb3VyY2VzOiBJcnZpbmUgUHVibGljIFdvcmtzXCIsXG4gICAgICBdLmpvaW4oXCJcXG5cIik7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICByZXBseTogZGVtbyxcbiAgICAgICAgZGV0ZWN0ZWRMYW5ndWFnZTogcmVxdWVzdGVkTGFuZyA9PT0gXCJhdXRvXCIgPyBcImVuXCIgOiByZXF1ZXN0ZWRMYW5nLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgY29tcGxldGlvbiA9IGF3YWl0IGNsaWVudC5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogcHJvY2Vzcy5lbnYuT1BFTkFJX01PREVMIHx8IFwiZ3B0LTRvLW1pbmlcIixcbiAgICAgIHRlbXBlcmF0dXJlOiAwLjIsXG4gICAgICBtZXNzYWdlczogbW9kZWxNZXNzYWdlcy5tYXAoKG0pID0+ICh7IHJvbGU6IG0ucm9sZSwgY29udGVudDogbS5jb250ZW50IH0pKSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlcGx5ID1cbiAgICAgIGNvbXBsZXRpb24uY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudD8udHJpbSgpIHx8XG4gICAgICBcIkkgY291bGRu4oCZdCBnZW5lcmF0ZSBhIHJlcGx5LiBQbGVhc2UgdHJ5IGFnYWluLlwiO1xuXG4gICAgLy8gU2ltcGxlIGRldGVjdGlvbiBlY2hvICh5b3UgY2FuIGltcHJvdmUgd2l0aCBhIGRldGVjdGlvbiBwYXNzIGlmIHlvdSBsaWtlKVxuICAgIGNvbnN0IGRldGVjdGVkTGFuZ3VhZ2UgPSByZXF1ZXN0ZWRMYW5nID09PSBcImF1dG9cIiA/IFwiZW5cIiA6IHJlcXVlc3RlZExhbmc7XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyByZXBseSwgZGV0ZWN0ZWRMYW5ndWFnZSB9KTtcbiAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShgQ2hhdCBBUEkgZXJyb3I6ICR7ZXJyPy5tZXNzYWdlIHx8IFwidW5rbm93biBlcnJvclwifWAsIHtcbiAgICAgIHN0YXR1czogNTAwLFxuICAgIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiT3BlbkFJIiwiZ2V0UmFnQ29udGV4dCIsImNsaWVudCIsInByb2Nlc3MiLCJlbnYiLCJPUEVOQUlfQVBJX0tFWSIsImFwaUtleSIsIklTT19UT19OQU1FIiwiZW4iLCJlcyIsInpoIiwia28iLCJmYSIsInZpIiwic3lzdGVtUHJvbXB0IiwidGFyZ2V0TGFuZ3VhZ2VOYW1lIiwiam9pbiIsIm1heER1cmF0aW9uIiwiUE9TVCIsInJlcSIsImJvZHkiLCJqc29uIiwiaGlzdG9yeSIsIm1lc3NhZ2VzIiwicmVxdWVzdGVkTGFuZyIsImxhbmd1YWdlIiwibGVuZ3RoIiwicXVlc3Rpb24iLCJyb2xlIiwiY29udGVudCIsImxhbmciLCJsYXN0VXNlciIsInJldmVyc2UiLCJmaW5kIiwibSIsInJlcGx5IiwiZGV0ZWN0ZWRMYW5ndWFnZSIsInN0YXR1cyIsInJhZyIsInRhcmdldCIsInN5cyIsInVzZXJXaXRoUmFnIiwibW9kZWxNZXNzYWdlcyIsImZpbHRlciIsImRlbW8iLCJjb21wbGV0aW9uIiwiY2hhdCIsImNvbXBsZXRpb25zIiwiY3JlYXRlIiwibW9kZWwiLCJPUEVOQUlfTU9ERUwiLCJ0ZW1wZXJhdHVyZSIsIm1hcCIsImNob2ljZXMiLCJtZXNzYWdlIiwidHJpbSIsImVyciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/rag.ts":
/*!********************!*\
  !*** ./lib/rag.ts ***!
  \********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   contextFor: () => (/* binding */ contextFor),\n/* harmony export */   getRagContext: () => (/* binding */ getRagContext),\n/* harmony export */   getRagLabels: () => (/* binding */ getRagLabels),\n/* harmony export */   retrieve: () => (/* binding */ retrieve)\n/* harmony export */ });\n/* harmony import */ var node_fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:fs */ \"node:fs\");\n/* harmony import */ var node_fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! node:path */ \"node:path\");\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(node_path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _data_faqs_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/data/faqs.json */ \"(rsc)/./data/faqs.json\");\n/* harmony import */ var _data_irvine_glossary_json__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/data/irvine_glossary.json */ \"(rsc)/./data/irvine_glossary.json\");\n// lib/rag.ts\n\n\n\n\nfunction tryLoad(sourceFolder) {\n    const p = node_path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"data\", sourceFolder, \"index.json\");\n    if (!node_fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(p)) return [];\n    try {\n        const raw = node_fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(p, \"utf8\");\n        const json = JSON.parse(raw);\n        return Array.isArray(json) ? json : [];\n    } catch  {\n        return [];\n    }\n}\nfunction shorten(s, n = 800) {\n    if (!s) return \"\";\n    return s.length <= n ? s : s.slice(0, n) + \"…\";\n}\n// Map exported docs into your simple RAGDoc shape\nfunction exportedAsRag(sourceFolder, docs) {\n    return docs.map((d, i)=>{\n        const title = d.title?.trim() || \"Untitled\";\n        const url = d.url || \"\";\n        const header = url ? `${title} — ${url}` : title;\n        return {\n            id: `${sourceFolder}-${d.id || i}`,\n            text: `${header}\\n\\n${shorten(d.text || \"\")}`,\n            source: sourceFolder\n        };\n    });\n}\n// --- build the unified corpus (FAQ + glossary + exported civic data) ---\nconst civicDocs = [\n    // your existing data:\n    ..._data_faqs_json__WEBPACK_IMPORTED_MODULE_2__.map((f, i)=>({\n            id: `faq-${i}`,\n            text: `${f.q} ${f.a}`,\n            source: \"faqs.json\"\n        })),\n    ...Object.entries(_data_irvine_glossary_json__WEBPACK_IMPORTED_MODULE_3__).map(([k, v], i)=>({\n            id: `glossary-${i}`,\n            text: `${k}: ${v}`,\n            source: \"irvine_glossary.json\"\n        })),\n    // newly exported sources (present only if you've run the exporters)\n    ...exportedAsRag(\"cityofirvine\", tryLoad(\"cityofirvine\")),\n    ...exportedAsRag(\"iusd\", tryLoad(\"iusd\")),\n    ...exportedAsRag(\"ocvote\", tryLoad(\"ocvote\")),\n    ...exportedAsRag(\"data_ca_gov\", tryLoad(\"data_ca_gov\"))\n];\n// --- same simple keyword scoring you already use ---\nfunction score(query, text) {\n    const q = query.toLowerCase().split(/\\W+/).filter(Boolean);\n    const t = text.toLowerCase();\n    return q.reduce((acc, term)=>acc + (t.includes(term) ? 1 : 0), 0);\n}\n/**\n * Existing API: retrieve top-k docs with a positive score.\n */ function retrieve(query, k = 5) {\n    return civicDocs.map((d)=>({\n            ...d,\n            s: score(query, d.text)\n        })).filter((d)=>d.s > 0).sort((a, b)=>b.s - a.s).slice(0, k);\n}\n/**\n * Existing API: returns a bullet list context (kept for backward compatibility).\n */ function contextFor(query) {\n    const hits = retrieve(query, 5);\n    // format: one bullet per hit, keep URLs visible when present\n    return hits.map((h)=>`- (${h.source}) ${h.text}`).join(\"\\n\");\n}\n/* ---------------- NEW: helpers for the conversational chatbot ---------------- */ /**\n * Returns up to k compact, labeled snippets for sandwiching into the chat prompt.\n * Format example:\n *\n * [#1 ocvote]\n * Ballot Dropbox Locations — https://ocvote.gov/...\n * ...snippet text...\n *\n * [#2 iusd]\n * Enrollment Requirements — https://iusd.org/...\n * ...snippet text...\n *\n * If there are no hits, returns \"\" (safe no-op).\n */ async function getRagContext(query, k = 3) {\n    const hits = retrieve(query, k);\n    if (hits.length === 0) return \"\";\n    const blocks = hits.map((h, i)=>{\n        // Keep your existing header (title — url) and trimmed body already stored in h.text\n        const safeText = truncate(h.text, 1200);\n        return `[#${i + 1} ${h.source}]\\n${safeText}`;\n    });\n    return blocks.join(\"\\n\\n\");\n}\n/**\n * Optional convenience helper if you want the labels (e.g., for \"Sources: [#1 ocvote], [#2 iusd]\").\n */ function getRagLabels(query, k = 3) {\n    const hits = retrieve(query, k);\n    return hits.map((h, i)=>`[#${i + 1} ${h.source}]`);\n}\n/* ---------------- internals ---------------- */ function truncate(s, max = 1200) {\n    return s.length <= max ? s : s.slice(0, max) + \" …\";\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBTSxDQUFDLEVBQUUsRUFBRUEsSUFBSSxFQUFFLENBQUMsRUFBRWdDLEVBQUV6QixNQUFNLENBQUMsQ0FBQyxDQUFDO0FBQ3JEO0FBRUEsK0NBQStDLEdBRS9DLFNBQVM2QixTQUFTNUMsQ0FBUyxFQUFFOEMsTUFBTSxJQUFJO0lBQ3JDLE9BQU85QyxFQUFFRSxNQUFNLElBQUk0QyxNQUFNOUMsSUFBSUEsRUFBRUcsS0FBSyxDQUFDLEdBQUcyQyxPQUFPO0FBQ2pEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2l2aWNsYW5nLy4vbGliL3JhZy50cz85MmUzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpYi9yYWcudHNcbmltcG9ydCBmcyBmcm9tIFwibm9kZTpmc1wiO1xuaW1wb3J0IHBhdGggZnJvbSBcIm5vZGU6cGF0aFwiO1xuXG5pbXBvcnQgZmFxcyBmcm9tIFwiQC9kYXRhL2ZhcXMuanNvblwiO1xuaW1wb3J0IGdsb3NzYXJ5IGZyb20gXCJAL2RhdGEvaXJ2aW5lX2dsb3NzYXJ5Lmpzb25cIjtcblxuZXhwb3J0IHR5cGUgUkFHRG9jID0geyBpZDogc3RyaW5nOyB0ZXh0OiBzdHJpbmc7IHNvdXJjZTogc3RyaW5nIH07XG5cbi8vIC0tLSBoZWxwZXJzIHRvIGxvYWQgZXhwb3J0ZWQgSlNPTnMgZnJvbSAvZGF0YS88c291cmNlPi9pbmRleC5qc29uIC0tLVxudHlwZSBFeHBvcnRlZERvYyA9IHtcbiAgaWQ/OiBzdHJpbmc7XG4gIHVybD86IHN0cmluZztcbiAgdGl0bGU/OiBzdHJpbmc7XG4gIHRleHQ6IHN0cmluZztcbiAgc291cmNlPzogc3RyaW5nOyAgICAgIC8vIGUuZy4sIFwib2N2b3RlXCJcbiAgc2VjdGlvbj86IHN0cmluZztcbiAgdGFncz86IHN0cmluZ1tdO1xufTtcblxuZnVuY3Rpb24gdHJ5TG9hZChzb3VyY2VGb2xkZXI6IHN0cmluZyk6IEV4cG9ydGVkRG9jW10ge1xuICBjb25zdCBwID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIFwiZGF0YVwiLCBzb3VyY2VGb2xkZXIsIFwiaW5kZXguanNvblwiKTtcbiAgaWYgKCFmcy5leGlzdHNTeW5jKHApKSByZXR1cm4gW107XG4gIHRyeSB7XG4gICAgY29uc3QgcmF3ID0gZnMucmVhZEZpbGVTeW5jKHAsIFwidXRmOFwiKTtcbiAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZShyYXcpO1xuICAgIHJldHVybiBBcnJheS5pc0FycmF5KGpzb24pID8ganNvbiA6IFtdO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gW107XG4gIH1cbn1cblxuZnVuY3Rpb24gc2hvcnRlbihzOiBzdHJpbmcsIG4gPSA4MDApIHtcbiAgaWYgKCFzKSByZXR1cm4gXCJcIjtcbiAgcmV0dXJuIHMubGVuZ3RoIDw9IG4gPyBzIDogcy5zbGljZSgwLCBuKSArIFwi4oCmXCI7XG59XG5cbi8vIE1hcCBleHBvcnRlZCBkb2NzIGludG8geW91ciBzaW1wbGUgUkFHRG9jIHNoYXBlXG5mdW5jdGlvbiBleHBvcnRlZEFzUmFnKHNvdXJjZUZvbGRlcjogc3RyaW5nLCBkb2NzOiBFeHBvcnRlZERvY1tdKTogUkFHRG9jW10ge1xuICByZXR1cm4gZG9jcy5tYXAoKGQsIGkpID0+IHtcbiAgICBjb25zdCB0aXRsZSA9IGQudGl0bGU/LnRyaW0oKSB8fCBcIlVudGl0bGVkXCI7XG4gICAgY29uc3QgdXJsID0gZC51cmwgfHwgXCJcIjtcbiAgICBjb25zdCBoZWFkZXIgPSB1cmwgPyBgJHt0aXRsZX0g4oCUICR7dXJsfWAgOiB0aXRsZTtcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IGAke3NvdXJjZUZvbGRlcn0tJHtkLmlkIHx8IGl9YCxcbiAgICAgIHRleHQ6IGAke2hlYWRlcn1cXG5cXG4ke3Nob3J0ZW4oZC50ZXh0IHx8IFwiXCIpfWAsXG4gICAgICBzb3VyY2U6IHNvdXJjZUZvbGRlciwgLy8ga2VlcCBmb2xkZXIgbmFtZSBhcyBzb3VyY2UgbGFiZWxcbiAgICB9O1xuICB9KTtcbn1cblxuLy8gLS0tIGJ1aWxkIHRoZSB1bmlmaWVkIGNvcnB1cyAoRkFRICsgZ2xvc3NhcnkgKyBleHBvcnRlZCBjaXZpYyBkYXRhKSAtLS1cbmNvbnN0IGNpdmljRG9jczogUkFHRG9jW10gPSBbXG4gIC8vIHlvdXIgZXhpc3RpbmcgZGF0YTpcbiAgLi4uZmFxcy5tYXAoKGY6IGFueSwgaTogbnVtYmVyKSA9PiAoe1xuICAgIGlkOiBgZmFxLSR7aX1gLFxuICAgIHRleHQ6IGAke2YucX0gJHtmLmF9YCxcbiAgICBzb3VyY2U6IFwiZmFxcy5qc29uXCIsXG4gIH0pKSxcbiAgLi4uT2JqZWN0LmVudHJpZXMoZ2xvc3NhcnkgYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nPikubWFwKChbaywgdl0sIGkpID0+ICh7XG4gICAgaWQ6IGBnbG9zc2FyeS0ke2l9YCxcbiAgICB0ZXh0OiBgJHtrfTogJHt2fWAsXG4gICAgc291cmNlOiBcImlydmluZV9nbG9zc2FyeS5qc29uXCIsXG4gIH0pKSxcblxuICAvLyBuZXdseSBleHBvcnRlZCBzb3VyY2VzIChwcmVzZW50IG9ubHkgaWYgeW91J3ZlIHJ1biB0aGUgZXhwb3J0ZXJzKVxuICAuLi5leHBvcnRlZEFzUmFnKFwiY2l0eW9maXJ2aW5lXCIsIHRyeUxvYWQoXCJjaXR5b2ZpcnZpbmVcIikpLFxuICAuLi5leHBvcnRlZEFzUmFnKFwiaXVzZFwiLCAgICAgICAgIHRyeUxvYWQoXCJpdXNkXCIpKSxcbiAgLi4uZXhwb3J0ZWRBc1JhZyhcIm9jdm90ZVwiLCAgICAgICB0cnlMb2FkKFwib2N2b3RlXCIpKSxcbiAgLi4uZXhwb3J0ZWRBc1JhZyhcImRhdGFfY2FfZ292XCIsICB0cnlMb2FkKFwiZGF0YV9jYV9nb3ZcIikpLFxuXTtcblxuLy8gLS0tIHNhbWUgc2ltcGxlIGtleXdvcmQgc2NvcmluZyB5b3UgYWxyZWFkeSB1c2UgLS0tXG5mdW5jdGlvbiBzY29yZShxdWVyeTogc3RyaW5nLCB0ZXh0OiBzdHJpbmcpIHtcbiAgY29uc3QgcSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xcVysvKS5maWx0ZXIoQm9vbGVhbik7XG4gIGNvbnN0IHQgPSB0ZXh0LnRvTG93ZXJDYXNlKCk7XG4gIHJldHVybiBxLnJlZHVjZSgoYWNjLCB0ZXJtKSA9PiBhY2MgKyAodC5pbmNsdWRlcyh0ZXJtKSA/IDEgOiAwKSwgMCk7XG59XG5cbi8qKlxuICogRXhpc3RpbmcgQVBJOiByZXRyaWV2ZSB0b3AtayBkb2NzIHdpdGggYSBwb3NpdGl2ZSBzY29yZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJldHJpZXZlKHF1ZXJ5OiBzdHJpbmcsIGsgPSA1KSB7XG4gIHJldHVybiBjaXZpY0RvY3NcbiAgICAubWFwKGQgPT4gKHsgLi4uZCwgczogc2NvcmUocXVlcnksIGQudGV4dCkgfSkpXG4gICAgLmZpbHRlcihkID0+IGQucyA+IDApXG4gICAgLnNvcnQoKGEsIGIpID0+IGIucyAtIGEucylcbiAgICAuc2xpY2UoMCwgayk7XG59XG5cbi8qKlxuICogRXhpc3RpbmcgQVBJOiByZXR1cm5zIGEgYnVsbGV0IGxpc3QgY29udGV4dCAoa2VwdCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSkuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb250ZXh0Rm9yKHF1ZXJ5OiBzdHJpbmcpIHtcbiAgY29uc3QgaGl0cyA9IHJldHJpZXZlKHF1ZXJ5LCA1KTtcbiAgLy8gZm9ybWF0OiBvbmUgYnVsbGV0IHBlciBoaXQsIGtlZXAgVVJMcyB2aXNpYmxlIHdoZW4gcHJlc2VudFxuICByZXR1cm4gaGl0c1xuICAgIC5tYXAoaCA9PiBgLSAoJHtoLnNvdXJjZX0pICR7aC50ZXh0fWApXG4gICAgLmpvaW4oXCJcXG5cIik7XG59XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0gTkVXOiBoZWxwZXJzIGZvciB0aGUgY29udmVyc2F0aW9uYWwgY2hhdGJvdCAtLS0tLS0tLS0tLS0tLS0tICovXG5cbi8qKlxuICogUmV0dXJucyB1cCB0byBrIGNvbXBhY3QsIGxhYmVsZWQgc25pcHBldHMgZm9yIHNhbmR3aWNoaW5nIGludG8gdGhlIGNoYXQgcHJvbXB0LlxuICogRm9ybWF0IGV4YW1wbGU6XG4gKlxuICogWyMxIG9jdm90ZV1cbiAqIEJhbGxvdCBEcm9wYm94IExvY2F0aW9ucyDigJQgaHR0cHM6Ly9vY3ZvdGUuZ292Ly4uLlxuICogLi4uc25pcHBldCB0ZXh0Li4uXG4gKlxuICogWyMyIGl1c2RdXG4gKiBFbnJvbGxtZW50IFJlcXVpcmVtZW50cyDigJQgaHR0cHM6Ly9pdXNkLm9yZy8uLi5cbiAqIC4uLnNuaXBwZXQgdGV4dC4uLlxuICpcbiAqIElmIHRoZXJlIGFyZSBubyBoaXRzLCByZXR1cm5zIFwiXCIgKHNhZmUgbm8tb3ApLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmFnQ29udGV4dChxdWVyeTogc3RyaW5nLCBrID0gMyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IGhpdHMgPSByZXRyaWV2ZShxdWVyeSwgayk7XG4gIGlmIChoaXRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIFwiXCI7XG5cbiAgY29uc3QgYmxvY2tzID0gaGl0cy5tYXAoKGgsIGkpID0+IHtcbiAgICAvLyBLZWVwIHlvdXIgZXhpc3RpbmcgaGVhZGVyICh0aXRsZSDigJQgdXJsKSBhbmQgdHJpbW1lZCBib2R5IGFscmVhZHkgc3RvcmVkIGluIGgudGV4dFxuICAgIGNvbnN0IHNhZmVUZXh0ID0gdHJ1bmNhdGUoaC50ZXh0LCAxMjAwKTtcbiAgICByZXR1cm4gYFsjJHtpICsgMX0gJHtoLnNvdXJjZX1dXFxuJHtzYWZlVGV4dH1gO1xuICB9KTtcblxuICByZXR1cm4gYmxvY2tzLmpvaW4oXCJcXG5cXG5cIik7XG59XG5cbi8qKlxuICogT3B0aW9uYWwgY29udmVuaWVuY2UgaGVscGVyIGlmIHlvdSB3YW50IHRoZSBsYWJlbHMgKGUuZy4sIGZvciBcIlNvdXJjZXM6IFsjMSBvY3ZvdGVdLCBbIzIgaXVzZF1cIikuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRSYWdMYWJlbHMocXVlcnk6IHN0cmluZywgayA9IDMpOiBzdHJpbmdbXSB7XG4gIGNvbnN0IGhpdHMgPSByZXRyaWV2ZShxdWVyeSwgayk7XG4gIHJldHVybiBoaXRzLm1hcCgoaCwgaSkgPT4gYFsjJHtpICsgMX0gJHtoLnNvdXJjZX1dYCk7XG59XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0gaW50ZXJuYWxzIC0tLS0tLS0tLS0tLS0tLS0gKi9cblxuZnVuY3Rpb24gdHJ1bmNhdGUoczogc3RyaW5nLCBtYXggPSAxMjAwKSB7XG4gIHJldHVybiBzLmxlbmd0aCA8PSBtYXggPyBzIDogcy5zbGljZSgwLCBtYXgpICsgXCIg4oCmXCI7XG59XG4iXSwibmFtZXMiOlsiZnMiLCJwYXRoIiwiZmFxcyIsImdsb3NzYXJ5IiwidHJ5TG9hZCIsInNvdXJjZUZvbGRlciIsInAiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsImV4aXN0c1N5bmMiLCJyYXciLCJyZWFkRmlsZVN5bmMiLCJqc29uIiwiSlNPTiIsInBhcnNlIiwiQXJyYXkiLCJpc0FycmF5Iiwic2hvcnRlbiIsInMiLCJuIiwibGVuZ3RoIiwic2xpY2UiLCJleHBvcnRlZEFzUmFnIiwiZG9jcyIsIm1hcCIsImQiLCJpIiwidGl0bGUiLCJ0cmltIiwidXJsIiwiaGVhZGVyIiwiaWQiLCJ0ZXh0Iiwic291cmNlIiwiY2l2aWNEb2NzIiwiZiIsInEiLCJhIiwiT2JqZWN0IiwiZW50cmllcyIsImsiLCJ2Iiwic2NvcmUiLCJxdWVyeSIsInRvTG93ZXJDYXNlIiwic3BsaXQiLCJmaWx0ZXIiLCJCb29sZWFuIiwidCIsInJlZHVjZSIsImFjYyIsInRlcm0iLCJpbmNsdWRlcyIsInJldHJpZXZlIiwic29ydCIsImIiLCJjb250ZXh0Rm9yIiwiaGl0cyIsImgiLCJnZXRSYWdDb250ZXh0IiwiYmxvY2tzIiwic2FmZVRleHQiLCJ0cnVuY2F0ZSIsImdldFJhZ0xhYmVscyIsIm1heCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/rag.ts\n");

/***/ }),

/***/ "(rsc)/./data/faqs.json":
/*!************************!*\
  !*** ./data/faqs.json ***!
  \************************/
/***/ ((module) => {

module.exports = /*#__PURE__*/JSON.parse('[{"q":"How do I register my child for school in IUSD?","a":"Visit the IUSD Enrollment website, gather required documents (proof of residency, immunization, birth certificate), and complete the online registration forms."},{"q":"Where do I report missed trash pickup?","a":"Contact the City\'s waste services provider or use the online service request portal; include your address and collection day."},{"q":"What are the green bin rules?","a":"Place food scraps and yard trimmings in the green bin. Do not include plastic bags or liquids."}]');

/***/ }),

/***/ "(rsc)/./data/irvine_glossary.json":
/*!***********************************!*\
  !*** ./data/irvine_glossary.json ***!
  \***********************************/
/***/ ((module) => {

module.exports = /*#__PURE__*/JSON.parse('{"Irvine Ranch Water District":"Local water agency serving Irvine; handles water and sewer services.","Community Choice Energy":"A program that lets cities buy or generate electricity for residents, often with greener options.","Green bin":"Green waste cart used for compostable materials like yard trimmings and food scraps in Irvine.","Ordinance":"A local law passed by the City Council.","Parcel tax":"A local tax on property (a \'parcel\') used to fund services like schools or safety."}');

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/formdata-node","vendor-chunks/openai","vendor-chunks/form-data-encoder","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/whatwg-url","vendor-chunks/qs","vendor-chunks/call-bind-apply-helpers","vendor-chunks/agentkeepalive","vendor-chunks/get-proto","vendor-chunks/tr46","vendor-chunks/object-inspect","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/web-streams-polyfill","vendor-chunks/node-fetch","vendor-chunks/webidl-conversions","vendor-chunks/side-channel","vendor-chunks/side-channel-weakmap","vendor-chunks/side-channel-map","vendor-chunks/side-channel-list","vendor-chunks/ms","vendor-chunks/humanize-ms","vendor-chunks/hasown","vendor-chunks/get-intrinsic","vendor-chunks/event-target-shim","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/call-bound","vendor-chunks/abort-controller"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=C%3A%5CCode%5Ccleanup%5CCivicLangApp%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CCode%5Ccleanup%5CCivicLangApp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();